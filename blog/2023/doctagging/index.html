<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
      }
    });
    </script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Tagging Document - LangChain | Mohammad Arshad</title> <meta name="author" content="Mohammad Arshad"> <meta name="description" content="Labelling/Classifying corpus using LangChain"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://mdarshad1000.github.io/blog/2023/doctagging/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">MohammadÂ </span>Arshad</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/experiences/">experiences</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/awards/">awards</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Tagging Document - LangChain</h1> <p class="post-meta">August 10, 2023</p> <p class="post-tags"> <a href="/blog/2023"> <i class="fas fa-calendar fa-sm"></i> 2023 </a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h3 id="tagging-document---langchain-">Tagging Document - LangChain ðŸ¦œ</h3> <p><code class="language-plaintext highlighter-rouge">Labelling/Classifying corpus using LangChain</code></p> <p>Recently LangChain introduced Document Tagging Chain. Tagging refers to simply assigning label(s) to a corpus. I will cover a basic demo of how document tagging works using LangChain. From analyzing sentiment in customer feedback to identifying the intensity oflanguage use, the potential applications of this technology are vast.</p> <p>I will take the text-book task for classification in Machine Learning i.e Email Classification to demonstrate tagging via langchain. We already have a plethora of tools in the market for classifying and filtering out emails. So how will using a Tagging chain from LangChain will be any different/better?</p> <p>Unfortunately, these tools are based on rule-based filtering and classification techniques, which may not capture the context and nuances of emails effectively. This is where we can power up the classification using tagging chain.</p> <ul> <li>Install the dependencies</li> </ul> <div class="language-zsh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">!</span>pip <span class="nb">install</span> <span class="nt">-qU</span> langchain pydantic
</code></pre></div></div> <ul> <li>Importing dependencies</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">langchain.chains</span> <span class="kn">import</span> <span class="n">LLMChain</span><span class="p">,</span> <span class="n">create_tagging_chain_pydantic</span>
<span class="kn">from</span> <span class="n">langchain.chat_models</span> <span class="kn">import</span> <span class="n">ChatOpenAI</span>
<span class="kn">from</span> <span class="n">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="n">pydantic</span> <span class="kn">import</span> <span class="n">BaseModel</span><span class="p">,</span> <span class="n">Fieldimport</span> 
<span class="kn">import</span> <span class="n">os</span>
</code></pre></div></div> <ul> <li>Prepare the source text</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">text_source</span> <span class="o">=</span> <span class="sh">"""</span><span class="s">
Subject: Urgent Concerns about the Reliability of WonderTech AI Product

Dear Arshad,

I am Bruce, the CTO at Microsoft. I am writing to express my deep disappointment regarding the recent issues with our AI product.

We value our longstanding partnership, and it is crucial that we address these concerns promptly. Please provide a comprehensive plan outlining the steps you will take to improve the reliability of our AI system.

I appreciate your partnership and trust that, by working together, we can overcome these challenges.

Sincerely,
Bruce
CTO
Microsoft

</span><span class="sh">"""</span>
</code></pre></div></div> <ul> <li>Create Tag description by Pydantic class</li> </ul> <p>I outlined four specific tags that provide a detailed description of the topic. These tags also include information about the senderâ€™s significance, the urgency of their message, and their feelings. These details assist the recipient in better organizing their emails for efficient management.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">EmailFeatures</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">topic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nc">Field</span><span class="p">(</span>
        <span class="bp">...</span>
        <span class="n">enum</span><span class="o">=</span><span class="p">[</span>
            <span class="sh">"</span><span class="s">Customer Complaint</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Follow-up</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Proposal</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Demo/Product Presentation</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Deal Negotiation</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Order Processing</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Customer Testimonials/Reviews</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Product Information Request</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Account Support</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Shipping and Delivery</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Payment and Billing</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Return and Refund</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Product Support</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Technical Support</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Partnership/Cooperation</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Event/Conference Invitation</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Webinar/Training Registration</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">Other</span><span class="sh">"</span>
        <span class="p">],</span>
    <span class="p">)</span>

    <span class="n">sender_weighs</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nc">Field</span><span class="p">(</span>
        <span class="p">...,</span>
        <span class="n">description</span><span class="o">=</span><span class="sh">"</span><span class="s">The importance of sender based on their title and company, and their content of the message</span><span class="sh">"</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">urgent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nc">Field</span><span class="p">(</span>
        <span class="p">...,</span>
        <span class="n">description</span><span class="o">=</span><span class="sh">"</span><span class="s">Score 1-10, 10 is the highest level of urgency</span><span class="sh">"</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">sentiment</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nc">Field</span><span class="p">(</span>
        <span class="p">...,</span>
        <span class="n">description</span><span class="o">=</span><span class="sh">"</span><span class="s">wether the email has a negative, positive or neutral sentiment</span><span class="sh">"</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></div> <ul> <li>setting up model and chain</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">os</span><span class="p">.</span><span class="n">environ</span><span class="p">[</span><span class="sh">"</span><span class="s">OPENAI_API_KEY</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">your_api_key</span><span class="o">&gt;</span>
<span class="n">llm</span> <span class="o">=</span> <span class="nc">ChatOpenAI</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="sh">"</span><span class="s">gpt-3.5-turbo-16k</span><span class="sh">"</span><span class="p">)</span>
<span class="n">tagging_chain</span> <span class="o">=</span> <span class="nf">create_tagging_chain_pydantic</span><span class="p">(</span><span class="n">EmailFeatures</span><span class="p">,</span> <span class="n">llm</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">tagging_chain</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">text_input</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre></div></div> <p>The output would be:</p> <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>topic='Customer Complaint', sender_weighs=10, urgent=10, sentiment='negative'
</code></pre></div></div> <p>These tags would give a clearer picture of the email to you without you having to read through the entire mail.</p> <p>Lastly, there are many other potential use cases such as:</p> <ul> <li>Resume Screening</li> <li>Medical Record Analaysis</li> <li>Legal Document Analysis</li> </ul> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/llamindexvlangchain/">LangChain vs (and?) LlamaIndex ðŸ¦œðŸ¦™</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/transformers/">Transformers</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/chatgpt/">ChatGPT</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2023/datasheet/">Navigating the Data Jungle</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/blog/2022/langchain/">LangChain ðŸ¦œ</a> </li> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> Â© Copyright 2023 Mohammad Arshad. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>